[2023-07-08 10:17:46,121] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@1a3869f4, name=log4j:logger=kafka.controller (kafka.controller)
[2023-07-08 10:18:46,185] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-07-08 10:18:46,249] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2023-07-08 10:18:46,249] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2023-07-08 10:18:46,264] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2023-07-08 10:18:46,295] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2023-07-08 10:18:46,295] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2023-07-08 10:18:46,421] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 24) (kafka.controller.KafkaController)
[2023-07-08 10:18:46,437] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2023-07-08 10:18:46,453] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2023-07-08 10:18:46,468] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2023-07-08 10:18:46,484] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2023-07-08 10:18:46,484] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2023-07-08 10:18:46,484] INFO [Controller id=1] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2023-07-08 10:18:46,484] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2023-07-08 10:18:46,484] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,484] INFO [Controller id=1] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,500] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2023-07-08 10:18:46,500] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2023-07-08 10:18:46,500] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2023-07-08 10:18:46,531] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2023-07-08 10:18:46,531] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-07-08 10:18:46,547] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-07-08 10:18:46,547] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2023-07-08 10:18:46,547] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2023-07-08 10:18:46,547] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2023-07-08 10:18:46,547] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9092 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-07-08 10:18:46,547] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2023-07-08 10:18:46,562] INFO [Controller id=1] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2023-07-08 10:18:46,562] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,562] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,562] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,578] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2023-07-08 10:18:46,578] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2023-07-08 10:18:46,594] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2023-07-08 10:18:51,618] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:18:51,618] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:21:16,519] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2023-07-08 10:21:16,519] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2023-07-08 10:21:16,550] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2023-07-08 10:21:16,550] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2023-07-08 10:21:16,550] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9093 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-07-08 10:21:16,566] DEBUG [Controller id=1] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2023-07-08 10:21:16,566] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24, 2 -> 43) (kafka.controller.KafkaController)
[2023-07-08 10:22:26,646] INFO [Controller id=1] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 1,2,3 (kafka.controller.KafkaController)
[2023-07-08 10:22:26,646] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2023-07-08 10:22:26,660] INFO [Controller id=1] New broker startup callback for 3 (kafka.controller.KafkaController)
[2023-07-08 10:22:26,660] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2023-07-08 10:22:26,660] DEBUG [Controller id=1] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2023-07-08 10:22:26,676] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24, 2 -> 43, 3 -> 59) (kafka.controller.KafkaController)
[2023-07-08 10:22:26,676] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9094 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-07-08 10:23:51,627] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:23:51,627] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:26:38,709] INFO [Controller id=1] New topics: [Set(first_topic)], deleted topics: [Set()], new partition replica assignment [Map(first_topic-0 -> ReplicaAssignment(replicas=3,2,1, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2023-07-08 10:26:38,709] INFO [Controller id=1] New partition creation callback for first_topic-0 (kafka.controller.KafkaController)
[2023-07-08 10:28:51,632] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:28:51,632] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:28:51,632] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
[2023-07-08 10:28:51,632] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:30:06,714] INFO [Controller id=1] New topics: [Set(__consumer_offsets)], deleted topics: [Set()], new partition replica assignment [HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2023-07-08 10:30:06,714] INFO [Controller id=1] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:33:51,650] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:35:26,170] INFO [Controller id=1] Shutting down broker 3 (kafka.controller.KafkaController)
[2023-07-08 10:35:26,170] DEBUG [Controller id=1] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2023-07-08 10:35:26,170] DEBUG [Controller id=1] Live brokers: 1,2 (kafka.controller.KafkaController)
[2023-07-08 10:35:26,215] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:3,ISR:3,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:35:26,278] WARN [RequestSendThread controllerId=1] Controller 1 epoch 1 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=1, brokerEpoch=59, partitionStates=[LeaderAndIsrPartitionState(topicName='first_topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 1], zkVersion=1, replicas=[3, 2, 1], addingReplicas=[], removingReplicas=[], isNew=false)], liveLeaders=(localhost:9093 (id: 2 rack: null))) to broker localhost:9094 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,404] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,529] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,639] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,749] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,858] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:26,972] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,078] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,188] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,298] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,408] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,518] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,628] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:35:27,722] INFO [Controller id=1] Newly added brokers: , deleted brokers: 3, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2023-07-08 10:35:27,722] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2023-07-08 10:35:27,737] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2023-07-08 10:35:27,737] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2023-07-08 10:35:27,737] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2023-07-08 10:35:27,753] INFO [Controller id=1] Broker failure callback for 3 (kafka.controller.KafkaController)
[2023-07-08 10:35:27,753] INFO [Controller id=1] Removed 3 from list of shutting down brokers. (kafka.controller.KafkaController)
[2023-07-08 10:35:27,863] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2023-07-08 10:35:27,874] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24, 2 -> 43) (kafka.controller.KafkaController)
[2023-07-08 10:37:34,511] INFO [Controller id=1] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 1,2,3 (kafka.controller.KafkaController)
[2023-07-08 10:37:34,511] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2023-07-08 10:37:34,526] INFO [Controller id=1] New broker startup callback for 3 (kafka.controller.KafkaController)
[2023-07-08 10:37:34,526] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2023-07-08 10:37:34,539] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9094 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-07-08 10:37:34,589] DEBUG [Controller id=1] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2023-07-08 10:37:34,605] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24, 2 -> 43, 3 -> 204) (kafka.controller.KafkaController)
[2023-07-08 10:37:38,826] DEBUG [Controller id=1] Sending MetadataRequest to Brokers: List(1, 2, 3) for TopicPartitions: ArrayBuffer(first_topic-0) (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 HashMap(first_topic-0 -> List(3, 2, 1)) (kafka.controller.KafkaController)
[2023-07-08 10:38:51,655] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 0.05555555555555555 (kafka.controller.KafkaController)
[2023-07-08 10:43:51,668] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-07-08 10:43:51,668] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-07-08 10:43:51,668] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:43:51,670] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:43:51,670] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2023-07-08 10:43:51,670] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2023-07-08 10:43:51,670] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 HashMap(first_topic-0 -> List(3, 2, 1)) (kafka.controller.KafkaController)
[2023-07-08 10:43:51,670] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 0.05555555555555555 (kafka.controller.KafkaController)
[2023-07-08 10:44:54,587] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@1a3869f4, name=log4j:logger=kafka.controller (kafka.controller)
[2023-07-08 10:45:43,015] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2023-07-08 10:45:43,015] DEBUG [Controller id=1] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2023-07-08 10:45:43,015] DEBUG [Controller id=1] Live brokers: 1,3 (kafka.controller.KafkaController)
[2023-07-08 10:45:43,047] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:3,ISR:1,3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:45:43,078] WARN [RequestSendThread controllerId=1] Controller 1 epoch 1 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=1, brokerEpoch=43, partitionStates=[LeaderAndIsrPartitionState(topicName='first_topic', partitionIndex=0, controllerEpoch=1, leader=3, leaderEpoch=2, isr=[1, 3], zkVersion=3, replicas=[3, 2, 1], addingReplicas=[], removingReplicas=[], isNew=false)], liveLeaders=(localhost:9094 (id: 3 rack: null))) to broker localhost:9093 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,204] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,329] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,439] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,549] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,690] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,800] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:43,910] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,020] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,130] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,240] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,350] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,460] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,586] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9093 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:45:44,633] INFO [Controller id=1] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 1,3 (kafka.controller.KafkaController)
[2023-07-08 10:45:44,633] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2023-07-08 10:45:44,633] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2023-07-08 10:45:44,633] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2023-07-08 10:45:44,633] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2023-07-08 10:45:44,633] INFO [Controller id=1] Broker failure callback for 2 (kafka.controller.KafkaController)
[2023-07-08 10:45:44,633] INFO [Controller id=1] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2023-07-08 10:45:44,711] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2023-07-08 10:45:44,711] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24, 3 -> 204) (kafka.controller.KafkaController)
[2023-07-08 10:46:08,672] INFO [Controller id=1] Shutting down broker 3 (kafka.controller.KafkaController)
[2023-07-08 10:46:08,672] DEBUG [Controller id=1] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2023-07-08 10:46:08,672] DEBUG [Controller id=1] Live brokers: 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:08,688] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:46:08,719] WARN [RequestSendThread controllerId=1] Controller 1 epoch 1 fails to send request (type: UpdateMetadataRequest=, controllerId=1, controllerEpoch=1, brokerEpoch=204, partitionStates=[UpdateMetadataPartitionState(topicName='first_topic', partitionIndex=0, controllerEpoch=1, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[3, 2, 1], offlineReplicas=[3, 2])], liveBrokers=UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='localhost', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='localhost', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker localhost:9094 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:08,829] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:08,939] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,050] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,159] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,269] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,379] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,490] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,600] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,710] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,820] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:09,930] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker localhost:9094 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:288)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:242)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-07-08 10:46:10,008] INFO [Controller id=1] Newly added brokers: , deleted brokers: 3, bounced brokers: , all live brokers: 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:10,008] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2023-07-08 10:46:10,008] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2023-07-08 10:46:10,008] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2023-07-08 10:46:10,008] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2023-07-08 10:46:10,008] INFO [Controller id=1] Broker failure callback for 3 (kafka.controller.KafkaController)
[2023-07-08 10:46:10,008] INFO [Controller id=1] Removed 3 from list of shutting down brokers. (kafka.controller.KafkaController)
[2023-07-08 10:46:10,103] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2023-07-08 10:46:10,103] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 24) (kafka.controller.KafkaController)
[2023-07-08 10:46:31,776] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:31,776] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:31,776] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2023-07-08 10:46:31,776] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:46:36,802] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:36,802] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:36,802] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2023-07-08 10:46:36,817] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:46:41,825] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:41,825] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2023-07-08 10:46:41,825] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2023-07-08 10:46:41,825] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),first_topic-0 -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:1,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-07-08 10:46:48,060] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-07-08 10:46:48,060] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-07-08 10:46:48,060] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-07-08 10:46:48,060] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2023-07-08 10:46:48,060] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2023-07-08 10:46:48,060] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-07-08 10:46:48,076] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-07-08 10:46:48,076] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2023-07-08 10:46:48,076] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2023-07-08 10:46:48,076] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2023-07-08 10:46:48,076] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
